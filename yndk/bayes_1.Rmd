---
title: "Bayes's Rule"
author: "서용덕"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.



```{r}
a = 1
b = 2
c = a + b
print(c)
```

## Bayes Update

```{r}
v1 = c(.01, .02, .03, .1, .1)
v2 = c(.05, .1, .05, .07, .2)
v3 = c(.1, .05, .03, .05, .04)

pxy = matrix(0, nrow=3, ncol=5)
pxy[1,] = v1
pxy[2,] = v2
pxy[3,] = v3

print(pxy)
```

### marginal
```{r}
px = rep(0, 5)  # zero vector of size 5
for (i in 1:5) {
  px[i] = sum(pxy[,i])
}
```

### conditional
```{r}
py_x <- pxy

for (i in 1:5) {
  py_x[,i] = pxy[,i] / px[i]
}
print(py_x)
```

Sanity check - the sum must be 1 for every i.
```{r}
for (i in 1:5) {
  s = sum(py_x[,i])
  print(paste(i, "sum = ", s))
}
```

### Now compute the posterior P(X|Y=y2)
```{r}
meas = 2  # Y=y_2

py2_x = py_x[2,]       # likelihood

py2_x_px = py2_x * px  # likelihood * prior

Z = sum(py2_x_px)      # normlization constant

px_y2 = py2_x_px / Z   # normalize to obtain a probability mass function

for (i in 1:5) {
  print(paste("P(X_", i, "|Y=y2) = ", px_y2[i]))
}
print(sum(px_y2))
```

```{r}
print(px_y2)
```


```{r}
barplot(px_y2, names=1:5, col='#800000')
```
